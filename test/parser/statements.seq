#%% pass
pass

#%% expr
a = 5; b = 3
print a, b  #: 5 3

#%% assign_types
a: list[int] = []
print a  #: []

#%% assign_types_err
a = 5
a = 3.3  #! ERROR: cannot unify .float and .int






#%% print
print 1,
print 1, 2  #: 1 1 2

#%% return
def foo():
    return 1
print foo()  #: 1

def bar():
    print 2
    return
    print 1
bar()  #: 2


#%% yield
def foo():
    yield 1
print [i for i in foo()], str(foo())[:16]  #: [1] <generator at 0x

#%% yield_void
def foo():
    yield
    print 1
y = foo()
print y.done()  #: False
y.next()  #: 1
# TODO: next() should work here!
print y.done()  #: True

#%% yield_return
def foo():
    yield 1
    return
    yield 2
print list(foo())  #: [1]


#%% assert
assert bool(2) == True
try:
    assert 3 == 4
except AssertionError:
    print 'assert failed'  #: assert failed

#%% while
a = 3
while a:
    print a
    a -= 1
#: 3
#: 2
#: 1

#%% for_break_continue
for i in range(10):
    if i % 2 == 0:
        continue
    print i
    if i >= 5:
        break
#: 1
#: 3
#: 5

#%% if
for a, b in [(1, 2), (3, 3), (5, 4)]:
    if a > b:
        print '1',
    elif a == b:
        print '=',
    else:
        print '2',
print '_'  #: 2 = 1 _

#%% extend
@extend
class int:
    def run_lola_run(self):
        while self > 0:
            yield self
            self -= 1
print list((5).run_lola_run())  #: [5, 4, 3, 2, 1]

#%% import

#%% try_throw
class MyError:
    _hdr: ExcHeader
    def __init__(self, message: str):
        self._hdr = ('MyError', message, '', '', 0, 0)
try:
    raise MyError("hello!")
except MyError as e:
    print e._hdr.msg  #: hello!
try:
    raise OSError("hello os!")
# TODO: except (MyError, OSError) as e:
#     print e._hdr.msg
except MyError:
    print "my"
except OSError:
    print "os"  #: os
finally:
    print "whoa"  #: whoa

#%% global
a = 1
def foo():
    global a
    a += 1
print a,
foo()
print a  #: 1 2

#%% global_scope_err
a = 1
def foo():
    a += 1
foo()  #! ERROR: variable 'a' is not global

#%% yield_from
def foo():
    yield from range(3)
    yield from range(10, 13)
    yield -1
print list(foo())  #: [0, 1, 2, 10, 11, 12, -1]

#%% with
class Foo:
    i: int
    def __enter__(self: Foo):
        print '> foo! ' + str(self.i)
    def __exit__(self: Foo):
        print '< foo! ' + str(self.i)
    def foo(self: Foo):
        print 'woof'
class Bar:
    s: str
    def __enter__(self: Bar):
        print '> bar! ' + self.s
    def __exit__(self: Bar):
        print '< bar! ' + self.s
    def bar(self: Bar):
        print 'meow'
with Foo(0) as f:
#: > foo! 0
    f.foo()  #: woof
#: < foo! 0
with Foo(1) as f, Bar('s') as b:
#: > foo! 1
#: > bar! s
    f.foo()  #: woof
    b.bar()  #: meow
#: < bar! s
#: < foo! 1
with Foo(2), Bar('t') as q:
#: > foo! 2
#: > bar! t
    print 'eeh'  #: eeh
    q.bar()  #: meow
#: < bar! t
#: < foo! 2


#%% auto_init
class X[T]:
    a: int = 4
    b: int
    c: T
    d: str = 'oops'

    def __str__(self):
        return f'X({self.a},{self.b},{self.c},{self.d})'

x = X[float]()
print x  #: X(4,0,0,oops)

y = X(c='darius',a=5)
print y  #: X(5,0,darius,oops)
